<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link id="favicon" rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Registration</title>
    
</head>

<body class="flex justify-center items-center h-screen">
    
    <div class="w-1/3 bg-white-200 p-8">
        <!-- Форма регистрации -->
        <form id="registration-form">
            <div class="mb-4">
                <label class="block text-sm font-bold mb-2 text-gray-700" for="username">Имя пользователя:</label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" name="username" placeholder="Введите имя пользователя">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-bold mb-2 text-gray-700" for="email">Email:</label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" name="email" placeholder="Введите email">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-bold mb-2 text-gray-700" for="password">Пароль:</label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" name="password" placeholder="Введите пароль">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-bold mb-2 text-gray-700" for="confirm-password">Подтвердите пароль:</label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="confirm-password" type="password" name="confirm-password" placeholder="Повторите пароль">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-bold mb-2 text-gray-700" for="skills">Навыки:</label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="skills" type="text" name="skills" placeholder="Введите навыки">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-bold mb-2 text-gray-700" for="profession">Основное направление:</label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="profession" type="text" name="profession" placeholder="Введите основное направление">
            </div>
            <div class="flex items-center justify-between mb-4">
                <button id="register-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                    Зарегистрироваться
                </button>
                <a class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800" href="/login">Уже есть аккаунт? Войти</a>
            </div>
        </form>
    </div>

    <script>
        const form = document.getElementById("registration-form");
        const registerButton = document.getElementById("register-button");

        registerButton.addEventListener("click", (event) => {
            event.preventDefault();

            const username = document.getElementById("username").value;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const confirmPassword = document.getElementById("confirm-password").value;
            const skills = document.getElementById("skills").value;
            const profession = document.getElementById("profession").value;

            if (password !== confirmPassword) {
                // Если пароли не совпадают, отобразить ошибку
                const errorElement = document.createElement("p");
                errorElement.textContent = "Пароли не совпадают";
                errorElement.classList.add("text-red-500", "text-sm", "mt-2");
                form.appendChild(errorElement);
                return;
            }

            const userData = {
                email: email,
                password: password,
                is_active: true,
                is_superuser: false,
                is_verified: false,
                id: 0,
                username: username,
                skills: skills,
                profession: profession
            };

          fetch("/auth/register", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify(userData)
          })
          .then(response => response.json())
          .then(data => {
            // Обработка ответа от сервера
            console.log(data);
            window.location.href = "/login"; // перенаправляем пользователя на главную страницу
          })
          .catch(error => {
            // Обработка ошибок
            console.error(error);
          });
        });
        
    </script>

</body>
</html>
